{% load static %}

<!DOCTYPE html>
<html lang="en">
   <head>
      <!-- basic -->
      <meta charset="utf-8">
      <meta http-equiv="X-UA-Compatible" content="IE=edge">
      <!-- mobile metas -->
      <meta name="viewport" content="width=device-width, initial-scale=1">
      <meta name="viewport" content="initial-scale=1, maximum-scale=1">
      <!-- site metas -->
      <title>niture</title>
      <meta name="keywords" content="">
      <meta name="description" content="">
      <meta name="author" content="">
      <!-- bootstrap css -->
      <link rel="stylesheet" href="{% static 'css/bootstrap.min.css' %}">
      <!-- style css -->
      <link rel="stylesheet" href="{% static 'css/style.css' %}">
      <!-- Responsive-->
      <link rel="stylesheet" href="{% static 'css/responsive.css' %}">
      <!-- fevicon -->
      <link rel="icon" href="{% static 'images/fevicon.png' %}" type="image/gif" />
      <!-- Scrollbar Custom CSS -->
      <link rel="stylesheet" href="{% static 'css/jquery.mCustomScrollbar.min.css' %}">
      <!-- Tweaks for older IEs-->
      <link rel="stylesheet" href="https://netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css">
      <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/2.1.5/jquery.fancybox.min.css" media="screen">
      <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script><![endif]-->
   </head>
   <!-- body -->
   <body class="main-layout contact_page">
      <!-- loader  -->
      <div class="loader_bg">
         <div class="loader"><img src="{% static 'images/loading.gif' %}" alt="#" /></div>
      </div>

     <div class="wrapper">

      <!-- end loader --> 
      <div class="sidebar">
         <!-- Sidebar  -->
        <nav id="sidebar">

            <div id="dismiss">
                <i class="fa fa-arrow-left"></i>
            </div>

            <ul class="list-unstyled components">
                
                <li>
                    <a href="{% url 'index' %}">Home</a>
                </li>
                <li>
                    <a href="{% url 'about_us'%}">About</a>
                </li>
                <li>
                    <a href="{% url 'view_products' %}">Product</a>
                </li>
                <li>
                    <a href="{% url 'view_blog' %}">Blog</a>
                </li>
                <li class="active">
                    <a href="{% url 'contact' %}">Contact Us</a>
                </li>
                <li>
                    <a href="">View my orders</a>
                </li>
            </ul>

        </nav>
      </div>
     
     <div id="content">
      <!-- header -->
      <header>
         <!-- header inner -->
         <div class="header">
           
         <div class="container-fluid">
             
            <div class="row">
               <div class="col-lg-3 logo_section">
                  <div class="full">
                     <div class="center-desk">
                        <div class="logo"> <a href="{% url 'index' %}"><img src="{% static 'images/logo.jpg' %}" alt="#"></a> </div>
                     </div>
                  </div>
               </div>
               <div class="col-lg-9">
                  <div class="right_header_info">
                     <ul>
                       

                         <li>
                           <button type="button" id="sidebarCollapse">
                              <img src="{% static 'images/menu_icon.png' %}" alt="#" />
                           </button>
                        </li>
                     </ul>
                  </div>
               </div>
            </div>
         </div>
            </div>
        
         <!-- end header inner --> 
      </header>
      <!-- end header -->
      
<div class="contactus">
   <div class="container-fluid">
            <div class="row">
               <div class="col-md-8 offset-md-2">
                  <div class="title">
                     <h2>Payment</h2>
                    
                  </div>
               </div>
            </div>
          </div>
</div>



 
      <!-- Total amount details -->
     
      <div class="container mt-5 mb-5 text-center">
        <h1>Payment</h1>
        <p>Total Amount to Pay for {{ cart_item.product.name }}: ${{ total_amount }}</p>

        <!-- Add a form or button to proceed to payment processing -->
        <!-- <form method="post" action="">
            {% csrf_token %}
             <br><br>
            <button type="submit" >Proceed to Pay</button>
        </form> -->
        <form id="paymentForm">
            {% csrf_token %}
            <script src="https://checkout.razorpay.com/v1/checkout.js"
            data-key="{{ razorpay_api_key }}"
            data-amount="{{ total_amount }}"
            data-name="Niture"
            data-description="{{cart_item.product.name}}"
            data-image=""
            data-prefill.name="{{user.username}}"
            data-prefill.email="{{user.email}}"
            data-theme.color="#F37254">
    </script>
            <input type="hidden" custom="Hidden Element" name="hidden">
        </form>
    </div>

   
    </div>

    <!-- end of total amount deatils -->

      
      <!--  footer --> 
      <footer>
         <div class="footer">
            <div class="container-fluid">
               <div class="border1">
               <div class="row">
                  <div class="col-xl-3 col-lg-3 col-md-3 col-sm-12">
                  
                    <img class="logo1" src="{% static 'images/logo1.jpg' %}"/>
                  </div>
            
                   <div class="col-xl-6 col-lg-6 col-md-6 col-sm-12">
                  
                    
                     <ul class="lik">
                        <li> <a href="{% url 'index' %}">Home</a></li>
                         <li> <a href="{% url 'about_us'%}">About</a></li>
                         <li> <a href="{% url 'view_products' %}">Product</a></li>
                         <li> <a href="{% url 'view_blog' %}">Blog</a></li>
                        <li> <a href="{% url 'contact' %}">Contact us</a></li>
                     </ul>
                  </div>
            
                  <div class="col-xl-3 col-lg-3 col-md-3 col-sm-12">
                     <ul class="sociel">
                         <li> <a href="#"><i class="fa fa-facebook-f"></i></a></li>
                         <li> <a href="#"><i class="fa fa-twitter"></i></a></li>
                         <li> <a href="#"><i class="fa fa-instagram"></i></a></li>
                         <li> <a href="#"><i class="fa fa-linkedin"></i></a></li>
                     </ul>
                  </div>
            </div>
            
                
                
          </div>
         </div>
         <div class="container">
            <div class="row">
               <div class="col-md-12">
                  <div class="new">
                     
               </div>
                <div class="col-md-12">
                  <div class="newtt">
                     <p>It is a long established fact that a reader will be distracted by the readable content of a page when looking at its layout. The point<br> of using Lorem I</p>
                  </div>
               </div>
            </div>

         </div>
            <div class="copyright">
               <p>Copyright 2019 All Right Reserved By Liji Mathew</p>
            </div>
         </div>
    
      </footer>
      <!-- end footer -->
   </div>

</div>

   <div class="overlay"></div>

      <!-- Javascript files--> 
      <script src="{% static 'js/jquery.min.js' %}"></script> 
      <script src="{% static 'js/popper.min.js' %}"></script> 
      <script src="{% static 'js/bootstrap.bundle.min.js' %}"></script> 
      <script src="{% static 'js/jquery-3.0.0.min.js' %}"></script> 
      <script src="{% static 'js/plugin.js' %}"></script> 
      <!-- sidebar --> 
      <script src="{% static 'js/jquery.mCustomScrollbar.concat.min.js' %}"></script> 
      <script src="{% static 'js/custom.js' %}"></script>
      <script src="https:cdnjs.cloudflare.com/ajax/libs/fancybox/2.1.5/jquery.fancybox.min.js"></script>
     <script type="text/javascript">
        $(document).ready(function () {
            $("#sidebar").mCustomScrollbar({
                theme: "minimal"
            });

            $('#dismiss, .overlay').on('click', function () {
                $('#sidebar').removeClass('active');
                $('.overlay').removeClass('active');
            });

            $('#sidebarCollapse').on('click', function () {
                $('#sidebar').addClass('active');
                $('.overlay').addClass('active');
                $('.collapse.in').toggleClass('in');
                $('a[aria-expanded=true]').attr('aria-expanded', 'false');
            });
        });
      </script>


      <script>
         $(document).ready(function(){
         $(".fancybox").fancybox({
         openEffect: "none",
         closeEffect: "none"
         });
         
         $(".zoom").hover(function(){
         
         $(this).addClass('transition');
         }, function(){
         
         $(this).removeClass('transition');
         });
         });
         
      </script> 



<script>
   // Razorpay Integration script

   document.getElementById('paymentForm').addEventListener('submit', function (e) {
    // Prevent the form submission
    e.preventDefault();

    var rzp = new Razorpay({
        // ... your existing configuration ...
        handler: function (response) {
            // Handle the successful payment response
            alert('Payment successful! Payment ID: ' + response.razorpay_payment_id);

            // Send payment details to the server for verification and order completion
            var xhr = new XMLHttpRequest();
            xhr.open('POST', '/handle_payment/', true);
            xhr.setRequestHeader('Content-Type', 'application/json');
            xhr.onreadystatechange = function () {
                if (xhr.readyState === 4) {
                    var jsonResponse = JSON.parse(xhr.responseText);
                    console.log(jsonResponse);
                    // You can handle the server response here
                }
            };

            // Customize the data you send to the server
            var requestData = {
                
                product_name: '{{ cart_item.product.name }}',
                total_amount: '{{ total_amount }}',
                payment_id: response.razorpay_payment_id
            };

            // Send the request with JSON data
            xhr.send(JSON.stringify(requestData));
        }
    });

    rzp.open();
});

</script>

   
    <!-- End of Razorpay integration script -->
   

   </body>
</html>